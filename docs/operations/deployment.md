# ë°°í¬ ë° ìš´ì˜ ê°€ì´ë“œ

DINOappì˜ í”„ë¡œë•ì…˜ ë°°í¬, ëª¨ë‹ˆí„°ë§, ìœ ì§€ë³´ìˆ˜ë¥¼ ìœ„í•œ ì™„ì „í•œ ìš´ì˜ ê°€ì´ë“œì…ë‹ˆë‹¤.

## ğŸš€ ë°°í¬ í”„ë¡œì„¸ìŠ¤

### ìë™í™”ëœ CI/CD íŒŒì´í”„ë¼ì¸

#### 1. GitHub Actions ì›Œí¬í”Œë¡œìš°

```yaml
# ìë™ íŠ¸ë¦¬ê±°
main ë¸Œëœì¹˜ í‘¸ì‹œ â†’ CI ì‹¤í–‰ â†’ ìŠ¤í…Œì´ì§• ë°°í¬ â†’ ìˆ˜ë™ ìŠ¹ì¸ â†’ í”„ë¡œë•ì…˜ ë°°í¬
```

#### 2. í’ˆì§ˆ ê²Œì´íŠ¸

```mermaid
graph LR
    A[ì½”ë“œ í‘¸ì‹œ] --> B[ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬]
    B --> C[í…ŒìŠ¤íŠ¸ ì‹¤í–‰]
    C --> D[E2E í…ŒìŠ¤íŠ¸]
    D --> E[ì„±ëŠ¥ í…ŒìŠ¤íŠ¸]
    E --> F[ë¹Œë“œ & íŒ¨í‚¤ì§•]
    F --> G[ìŠ¤í…Œì´ì§• ë°°í¬]
    G --> H[ìˆ˜ë™ ìŠ¹ì¸]
    H --> I[í”„ë¡œë•ì…˜ ë°°í¬]
```

### ìˆ˜ë™ ë°°í¬

#### ê°œë°œ í™˜ê²½

```bash
npm run dev
```

#### ìŠ¤í…Œì´ì§• ë°°í¬

```bash
# Vercel ìŠ¤í…Œì´ì§• í™˜ê²½
vercel --env NODE_ENV=staging
```

#### í”„ë¡œë•ì…˜ ë°°í¬

```bash
# í”„ë¡œë•ì…˜ ë°°í¬ (ìˆ˜ë™)
vercel --prod

# ë˜ëŠ” npm ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©
npm run deploy:production
```

### í™˜ê²½ ì„¤ì •

#### í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬

```bash
# í”„ë¡œë•ì…˜ í™˜ê²½ ë³€ìˆ˜ (Vercel)
DATABASE_URL=postgresql://...
NEXTAUTH_SECRET=production-secret
NEXTAUTH_URL=https://dinoapp.vercel.app
GOOGLE_CLIENT_ID=prod-client-id
GOOGLE_CLIENT_SECRET=prod-client-secret
```

#### ìŠ¤í…Œì´ì§• í™˜ê²½ ë³€ìˆ˜

```bash
# ìŠ¤í…Œì´ì§• í™˜ê²½ ë³€ìˆ˜
NODE_ENV=staging
DATABASE_URL=postgresql://staging-db...
NEXTAUTH_URL=https://dinoapp-staging.vercel.app
```

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ

### ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§

#### í—¬ìŠ¤ ì²´í¬ ì—”ë“œí¬ì¸íŠ¸

```typescript
// GET /api/health
{
  "status": "healthy",
  "timestamp": "2024-01-30T12:00:00Z",
  "version": "1.0.0",
  "checks": {
    "database": "healthy",
    "external_apis": "healthy",
    "memory": "75%",
    "cpu": "45%"
  }
}
```

#### ìë™ ëª¨ë‹ˆí„°ë§ ìŠ¤í¬ë¦½íŠ¸

```bash
# ë°°í¬ í›„ 30ë¶„ê°„ ìë™ ëª¨ë‹ˆí„°ë§
npm run deploy:monitor https://dinoapp.vercel.app 30

# í—¬ìŠ¤ ì²´í¬ ìŠ¤í¬ë¦½íŠ¸
npm run deploy:health-check https://dinoapp.vercel.app
```

### ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

#### ì£¼ìš” ì§€í‘œ

- **ì‘ë‹µ ì‹œê°„**: API < 200ms, í˜ì´ì§€ ë¡œë“œ < 3ì´ˆ
- **ì—ëŸ¬ìœ¨**: < 0.1%
- **ê°€ìš©ì„±**: 99.9% ì—…íƒ€ì„
- **ì²˜ë¦¬ëŸ‰**: 1000 req/sec

#### ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ

```
/admin/monitoring
- ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­
- ì˜¤ë¥˜ ë¡œê·¸
- ì„±ëŠ¥ ê·¸ë˜í”„
- ì•Œë¦¼ ìƒíƒœ
```

### ë¡œê·¸ ê´€ë¦¬

#### ë¡œê·¸ ë ˆë²¨

```typescript
// êµ¬ì¡°í™”ëœ ë¡œê¹…
logger.info('ì‚¬ìš©ì ë¡œê·¸ì¸', { userId, ip, timestamp });
logger.warn('API ì‘ë‹µ ì§€ì—°', { endpoint, duration, threshold });
logger.error('ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨', { error, retryCount });
```

#### ë¡œê·¸ ì§‘ê³„

- **Vercel Logs**: ê¸°ë³¸ ë¡œê·¸ ìˆ˜ì§‘
- **Structured Logging**: JSON í˜•íƒœ ë¡œê·¸
- **Error Tracking**: ì˜¤ë¥˜ ìë™ ì¶”ì 

## ğŸ”§ ìœ ì§€ë³´ìˆ˜

### ì •ê¸° ìœ ì§€ë³´ìˆ˜ ì‘ì—…

#### ì¼ì¼ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ì‹œìŠ¤í…œ í—¬ìŠ¤ ì²´í¬ í™•ì¸
- [ ] ì˜¤ë¥˜ ë¡œê·¸ ê²€í† 
- [ ] ì„±ëŠ¥ ë©”íŠ¸ë¦­ í™•ì¸
- [ ] ë°±ì—… ìƒíƒœ ì ê²€

#### ì£¼ê°„ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ ë¶„ì„
- [ ] ë³´ì•ˆ ì—…ë°ì´íŠ¸ í™•ì¸
- [ ] ì‚¬ìš©ì í”¼ë“œë°± ê²€í† 
- [ ] ìš©ëŸ‰ ì‚¬ìš©ëŸ‰ ë¶„ì„

#### ì›”ê°„ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ì˜ì¡´ì„± ì—…ë°ì´íŠ¸
- [ ] ë³´ì•ˆ ê°ì‚¬
- [ ] ì„±ëŠ¥ ìµœì í™” ê²€í† 
- [ ] ë°±ì—… ë³µêµ¬ í…ŒìŠ¤íŠ¸

### ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬

#### ë°±ì—… ì „ëµ

```bash
# ìë™ ë°±ì—… (ë§¤ì¼ 03:00)
0 3 * * * /app/scripts/backup/backup-db.js

# ìˆ˜ë™ ë°±ì—…
npm run backup:db

# ë°±ì—… ìƒíƒœ í™•ì¸
npm run backup:status
```

#### ë§ˆì´ê·¸ë ˆì´ì…˜

```bash
# ìŠ¤í‚¤ë§ˆ ë³€ê²½
npx prisma migrate deploy

# í”„ë¡œë•ì…˜ ë§ˆì´ê·¸ë ˆì´ì…˜ (ì‹ ì¤‘íˆ)
DATABASE_URL=$PROD_DB_URL npx prisma migrate deploy
```

### ë³´ì•ˆ ê´€ë¦¬

#### ì •ê¸° ë³´ì•ˆ ê²€ì‚¬

```bash
# ì˜ì¡´ì„± ì·¨ì•½ì  ìŠ¤ìº”
npm audit

# ë³´ì•ˆ ì—…ë°ì´íŠ¸
npm audit fix

# ê³ ìœ„í—˜ ì·¨ì•½ì ë§Œ í™•ì¸
npm audit --audit-level high
```

#### SSL/TLS ì¸ì¦ì„œ

- **Vercel**: ìë™ SSL ì¸ì¦ì„œ ê´€ë¦¬
- **ê°±ì‹ **: ìë™ ê°±ì‹  (ë³„ë„ ì‘ì—… ë¶ˆí•„ìš”)
- **ëª¨ë‹ˆí„°ë§**: ë§Œë£Œì¼ ìë™ ì¶”ì 

## ğŸš¨ ì¥ì•  ëŒ€ì‘

### ê¸´ê¸‰ ìƒí™© ëŒ€ì‘ ì ˆì°¨

#### 1. ì¥ì•  ê°ì§€

```bash
# ìë™ ì•Œë¦¼ ì±„ë„
- Slack: #alerts ì±„ë„
- ì´ë©”ì¼: ops@dinoapp.com
- SMS: ì£¼ìš” ë‹´ë‹¹ì (ì˜µì…˜)
```

#### 2. ì´ˆê¸° ëŒ€ì‘ (5ë¶„ ì´ë‚´)

1. **ìƒí™© íŒŒì•…**: í—¬ìŠ¤ ì²´í¬ ë° ë¡œê·¸ í™•ì¸
2. **ì„ì‹œ ì¡°ì¹˜**: íŠ¸ë˜í”½ ì œí•œ ë˜ëŠ” ê¸°ëŠ¥ ë¹„í™œì„±í™”
3. **íŒ€ ì•Œë¦¼**: ê°œë°œíŒ€ ë° ì´í•´ê´€ê³„ì í†µë³´

#### 3. ì¥ì•  ë³µêµ¬

```bash
# ê¸´ê¸‰ ë¡¤ë°±
npm run deploy:rollback

# ë˜ëŠ” ìë™ ë¡¤ë°± (3íšŒ ì—°ì† ì‹¤íŒ¨ì‹œ)
# CI/CD íŒŒì´í”„ë¼ì¸ì—ì„œ ìë™ ì‹¤í–‰
```

#### 4. ì‚¬í›„ ë¶„ì„

- ì¥ì•  ì›ì¸ ë¶„ì„
- ê°œì„  ë°©ì•ˆ ë„ì¶œ
- ì˜ˆë°© ì¡°ì¹˜ ì‹œí–‰
- í¬ìŠ¤íŠ¸ëª¨í…œ ë¬¸ì„œ ì‘ì„±

### ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²°

#### ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë¬¸ì œ

```bash
# ì—°ê²° ìƒíƒœ í™•ì¸
npx prisma db pull

# ì—°ê²° í’€ ì¬ì‹œì‘
# (Prisma í´ë¼ì´ì–¸íŠ¸ ì¬ìƒì„±)
npx prisma generate
```

#### ë†’ì€ ì‘ë‹µ ì‹œê°„

```bash
# ì„±ëŠ¥ í”„ë¡œíŒŒì¼ë§
npm run perf:analyze

# ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ìµœì í™”
# (ëŠë¦° ì¿¼ë¦¬ ë¡œê·¸ í™•ì¸)
```

#### API ì˜¤ë¥˜ìœ¨ ì¦ê°€

```bash
# ì˜¤ë¥˜ ë¡œê·¸ ë¶„ì„
tail -f /var/log/app/error.log

# íŠ¹ì • ì—”ë“œí¬ì¸íŠ¸ ë¹„í™œì„±í™” (ì„ì‹œ)
# feature flag ë˜ëŠ” ì„¤ì • ë³€ê²½
```

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### í”„ë¡ íŠ¸ì—”ë“œ ìµœì í™”

#### ë¹Œë“œ ìµœì í™”

```bash
# ë²ˆë“¤ í¬ê¸° ë¶„ì„
npm run build:analyze

# ì´ë¯¸ì§€ ìµœì í™”
# Next.js Image ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©

# ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…
# dynamic imports í™œìš©
```

#### ìºì‹± ì „ëµ

```javascript
// API ì‘ë‹µ ìºì‹±
export const revalidate = 300; // 5ë¶„

// Static íŒŒì¼ ìºì‹±
// Vercel CDN ìë™ ì„¤ì •
```

### ë°±ì—”ë“œ ìµœì í™”

#### ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”

```sql
-- ì¸ë±ìŠ¤ ì¶”ê°€
CREATE INDEX idx_travel_records_user_id ON TravelRecord(userId);
CREATE INDEX idx_travel_records_date ON TravelRecord(entryDate);

-- ì¿¼ë¦¬ ìµœì í™”
EXPLAIN ANALYZE SELECT * FROM TravelRecord WHERE userId = $1;
```

#### API ì„±ëŠ¥ í–¥ìƒ

```typescript
// ì—°ê²° í’€ë§
const prisma = new PrismaClient({
  datasources: {
    db: {
      url: process.env.DATABASE_URL + '?connection_limit=20',
    },
  },
});

// ì¿¼ë¦¬ ìµœì í™”
const records = await prisma.travelRecord.findMany({
  where: { userId },
  select: { id: true, countryCode: true, entryDate: true }, // í•„ìš”í•œ í•„ë“œë§Œ
  take: 10, // í˜ì´ì§€ë„¤ì´ì…˜
});
```

## ğŸ”„ ì—…ë°ì´íŠ¸ ê´€ë¦¬

### ì˜ì¡´ì„± ì—…ë°ì´íŠ¸

#### ì •ê¸° ì—…ë°ì´íŠ¸ (ì›”ê°„)

```bash
# ì˜ì¡´ì„± í™•ì¸
npm outdated

# ì•ˆì „í•œ ì—…ë°ì´íŠ¸
npm update

# ë©”ì´ì € ë²„ì „ ì—…ë°ì´íŠ¸ (ì‹ ì¤‘íˆ)
npm install package@latest
```

#### ë³´ì•ˆ ì—…ë°ì´íŠ¸ (ì¦‰ì‹œ)

```bash
# ë³´ì•ˆ ì·¨ì•½ì  ìˆ˜ì •
npm audit fix

# ê³ ìœ„í—˜ ì·¨ì•½ì  ê°•ì œ ìˆ˜ì •
npm audit fix --force
```

### ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### ì½”ë“œ ë¦¬ë·°

- [ ] PR ê²€í†  ì™„ë£Œ
- [ ] í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ìœ ì§€
- [ ] ë³´ì•ˆ ê²€í†  í†µê³¼
- [ ] ì„±ëŠ¥ ì˜í–¥ ë¶„ì„

#### ë°°í¬ ì¤€ë¹„

- [ ] í™˜ê²½ ë³€ìˆ˜ í™•ì¸
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ê²€í† 
- [ ] ë¡¤ë°± ê³„íš ìˆ˜ë¦½
- [ ] ëª¨ë‹ˆí„°ë§ ì¤€ë¹„

## ğŸ“Š ìš©ëŸ‰ ê´€ë¦¬

### ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§

```bash
# ë°ì´í„°ë² ì´ìŠ¤ í¬ê¸° í™•ì¸
SELECT
  schemaname,
  tablename,
  pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) as size
FROM pg_tables
ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;

# íŒŒì¼ ì €ì¥ì†Œ ì‚¬ìš©ëŸ‰
# Vercel Blob ëŒ€ì‹œë³´ë“œì—ì„œ í™•ì¸
```

### í™•ì¥ì„± ê³„íš

- **ìˆ˜ì§ í™•ì¥**: ë” í° ì¸ìŠ¤í„´ìŠ¤ë¡œ ì—…ê·¸ë ˆì´ë“œ
- **ìˆ˜í‰ í™•ì¥**: ë¡œë“œ ë°¸ëŸ°ì‹± (Vercel ìë™ ì²˜ë¦¬)
- **ë°ì´í„°ë² ì´ìŠ¤ ìƒ¤ë”©**: ì‚¬ìš©ìë³„ ë°ì´í„° ë¶„ì‚°
- **CDN í™œìš©**: ì •ì  ìì‚° ì „ì—­ ë°°í¬

## ğŸ“ ì§€ì› ë° ë¬¸ì˜

### ìš´ì˜íŒ€ ì—°ë½ì²˜

- **ì¼ë°˜ ë¬¸ì˜**: ops@dinoapp.com
- **ê¸´ê¸‰ ìƒí™©**: +82-10-XXXX-XXXX
- **Slack**: #ops-team ì±„ë„

### ì™¸ë¶€ ì„œë¹„ìŠ¤ ì§€ì›

- **Vercel**: support@vercel.com
- **Supabase**: support@supabase.io
- **Google APIs**: Google Cloud Support

---

**ê´€ë ¨ ë¬¸ì„œ**: [ëª¨ë‹ˆí„°ë§ ê°€ì´ë“œ](./monitoring.md) | [ë³´ì•ˆ ê°€ì´ë“œ](./security.md) | [ë°±ì—… ê°€ì´ë“œ](./backup.md)
